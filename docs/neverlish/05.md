---
marp: true
paginate: true
backgroundColor: #000
color: #fff
---

# 05. 안정 해시 설계
- 안정해시: 요청, 데이터를 서버에 균등하게 나누기 위해 보편적으로 사용하는 기술

--- 

# 해시 키 재배치(rehash) 문제

- serverIndex = hash(key) % 서버갯수
  - 위 방법은, 서버가 추가/삭제될 때 문제가 생김
     -> 대규모 캐시미스가 발생

---

# 안정 해시

- 해시 테이블의 크기가 조정될 때
  - 전통적 해시 테이블: 대부분의 키를 재배치
  - 안정 해시: 평균적으로 k/n개의 키만 재배치하는 기술
    - k: 키의 개수
    - n: 슬록의 개수

- 기본 절차
  - 서버와 키를 균등 분포 해시 함수를 사용해 해시 링에 배치
  - 키의 위치에서 링을 시계 방향으로 탐색하다 만나는 최초의 서버가 키가 저장될 서버

--- 

## 기존 구현법의 두 가지 문제

1. 파티션읠 크기를 균등하게 유지하는 게 불가능
2. 키의 균등 분포를 달성하기가 어렵다
  - 가상노드 or 복제 기법이 제안됨

---

## 가상 노드

- 가상 노드
  - 실제노드, 또는 서버를 가리키는 노드
  - 하나의 서버는 링 위에 여러 개의 가상 노드를 가질 수 잇음
- 가상 노드의 개수를 늘리면 키의 분포는 점ㅈ머 균등해짐
  - 하지만, 가상 노드 데이터를 저장할 공간이 더 많이 필요해짐

