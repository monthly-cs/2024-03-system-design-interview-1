## 2단계 - 개략적인 설계안 제시 및 동의 구하기 
##### HTML 다운로더

인터넷에서 웹 페이지를 다운로드 하는 컴포넌트
다운로드할 페이지의 URL은 미수집 URL 저장소가 제공한다.

#### 도메인 이름 변환기

URL을 IP 주소로 변환하는 절차 필요
HTML 다운로더는 도메인 이름 변환기를 사용하여 URL에 대응하는 IP 주소를 알아낸다.

#### 콘텐츠 파서

불필요한 웹페이지 저장을 막기 위해서 파싱(parsing)과 검증(validation) 절차를 거쳐야 한다.
크롤링 서버 안이 아닌(성능 이슈 때문에) 독립된 컴포넌트이다.

#### 중복 콘텐츠 인가?

같은 정보를 저장하는 것을 예방하는 로직, 자료구조 이용

#### 콘텐츠 저장소

HTML 문서를 보관하는 시스템

데이터의 유형, 크기, 저장소 접근 빈도, 데이터의 유효기간 등    
종합적으로 고려한다.

- 데이터양이 매우 많으므로, 대부분의 콘텐츠는 디스크에 저장한다.
- 인기 있는 콘텐츠는 메모리에 두어 접근 지연 시간을 줄일 것이다.
  
#### URL 추출기

HTML을 파싱하여 링크들을 골라내는 역할을 한다.

#### URL 필터

특정한 URL을 크롤링 대상에서 제외하는 역할.   

```
ex) 특정한 콘텐츠 타입, 파일 확장자를 가지는 URL, 접속 시 오류가 발생하는 URL, 접근 제의 목록에 포함된 URL 등을 
```

#### 이미 방문한 URL

같은 URL 작업을 여러번 처리하는 과정 생략,

블룸 필터를 대표적으로 사용함

#### URL 저장소

이미 방문한 URL을 저장하는 저장소.   


### 웹 크롤러 작업 흐름

![](https://i.imgur.com/N7mjlOs.png)

```
1.  시작 URL들을 미수집 URL 저장소에 저장
2.  HTML다운로더는 미수집 URL저장소에서 URL 목록을 가져옴.
3.  HTML 다운로더는 도메인 이름 변환기를 사용, URL의 IP 주소를 알아내고, 해당 IP 주소로 접속하여 웹 페이지를 다운받는다.
4.  콘텐츠 파서는 다운된 HTML 페이지를 파싱하여 올바른 형식을 갖춘 페이지인지 검증.
5.  콘텐츠 파싱과 검증이 끝나면, 중복 콘텐츠인지 확인하는 절차를 개시.
6.  중복 콘텐츠인지 확인 위해, 해당 페이지가 이미 저장소에 존재하는지 확인.
   - 이미 저장소에 있는 경우, 처리하지 않고 버림.
   - 저장소에 없는 경우, 저장소에 저장 후, URL 추출기로 전달.
7.  URL 추출기는 해당 HTML페이지에서 링크를 골라냄.
8.  골라낸 링크를 URL필터로 전달 
9.  필터링이 끝난 후, 남은 URL 만 중복 URL 판별 단계로 전달.
10. 이미 처리한 URL인지 확인 위해 URL 저장소에서 보관된 URL인지 살핀다. 이미 저장소에 있는 URL은 버린다.
11. 저장소에 없는 URL은 URL 저장소에 저장 + 미수집 저장소에도 전달.
```